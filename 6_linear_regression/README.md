# HH.ru linear regression model

Обучение модели линейной регрессии на датасете с HH.ru.
Запуск предсказаний на модели с загрузкой сохраненных ранее весов:

```bash
python 6_linear_regression/app.py path/to/x_data.npy path/to/y_data.npy
```

В директории resources после обучения модели создается файл `salary_model.joblib` с сохраненными весами.

## Стратегия обучения модели

Перед началом работы дропаем все полностью дублирующиеся строки (строки, где дубликатами был только X, были
сгруппированы ранее при парсинге).
Разделяем данные на обучающую и валидационную выборки при помощи `train_test_split`; скалируем X при
помощи `Standard Scaler` (`MinMax Scaler` давал более плохие результаты), а также логарифмируем y, чтобы сгладить
выбросы.

Выбрана модель `RidgeCV` (`Ridge`), подбирающая наиболее подходящий коэффициент регуляризации `alpfa`; после обучения
печатаются ее основные характеристики на валидационной выборке: MAE, RMSE, R^2, MAPE, а также подобранный коэффициент.

Затем веса модели вместе со скейлером сохраняются по заданному пути.

Метрики обученной модели, веса которой сохранены в репозитори (`alpha` = 2222.99):
```
=== Validation metrics (Ridge) ===
MAE:             28219.91 RUB
RMSE:            48683.85 RUB
R^2:             0.4725
NMAE (mean y):   0.349 (~34.9%)
NMAE (median y): 0.470 (~47.0%)
MAPE:            37.7%
```